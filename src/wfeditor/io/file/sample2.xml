<?xml version="1.0" encoding="UTF-8"?>
<workflow>
  <meta>
    <wf-name>sample 1</wf-name>
    <wf-ver>1.3</wf-ver>
    <wf-format-ver>1.0</wf-format-ver>
    <parent>
      <parent-ver>1.2</parent-ver>
      <parent-file>/home/echeran/wfeditor/src/wfeditor/io/file/sample1.xml</parent-file>
      <parent-hash>1bf50a9a9a11381de0b121f872483a4139c233e8</parent-hash>
    </parent>
  </meta>
  <jobs>
    <job>
      <name>dir-contents</name>
      <prog-exec-loc>ls</prog-exec-loc>
      <prog-args>
        <arg>~echeran</arg>
      </prog-args>
      <prog-opts>
        <opt>
          <flag>-l</flag>
          <val/>
        </opt>
      </prog-opts>
    </job>
    <job>
      <name>filter-size</name>
      <prog-exec-loc>awk</prog-exec-loc>
      <prog-args>
        <arg>'{if (NF &gt; 4) {print $5;}}'</arg>
      </prog-args>
      <prog-opts/>
      <deps>
        <dep>dir-contents</dep>
      </deps>
    </job>
    <job>
      <name>build-sum-commands</name>
      <prog-exec-loc>awk</prog-exec-loc>
      <prog-args>
        <arg>'{print "a = a + " $1} END {print "a";}'</arg>
      </prog-args>
      <prog-opts/>
      <deps>
        <dep>filter-size</dep>
      </deps>
    </job>
    <job>
      <name>compute-sum</name>
      <prog-exec-loc>bc</prog-exec-loc>
      <prog-args/>
      <prog-opts/>
      <deps>
        <dep>build-sum-commands</dep>
      </deps>
    </job>
    <job>
      <name>sum-pr</name>
      <prog-exec-loc>ruby</prog-exec-loc>
      <prog-args/>
      <prog-opts>
        <opt>
          <flag>-lane</flag>
          <val>'puts "B. sum of file sizes =" + $F[0].to_s'</val>
        </opt>
      </prog-opts>
      <deps>
        <dep>compute-sum</dep>
      </deps>
    </job>
    <job>
      <name>rand-passwd</name>
      <prog-exec-loc>ruby</prog-exec-loc>
      <prog-args/>
      <prog-opts>
        <opt>
          <flag>-lane</flag>
          <val>'puts "cat /dev/urandom | tr -dc _A-Z-a-z-0-9 | head -c" + $F[0]'</val>
        </opt>
      </prog-opts>
      <deps>
        <dep>compute-sum</dep>
      </deps>
    </job>
    <job>
      <name>shell</name>
      <prog-exec-loc>sh</prog-exec-loc>
      <prog-args/>
      <prog-opts/>
      <deps>
        <dep>rand-passwd</dep>
      </deps>
    </job>
    <job>
      <name>dir2-contents</name>
      <prog-exec-loc>ls</prog-exec-loc>
      <prog-args>
        <arg>~echeran/wfeditor</arg>
      </prog-args>
      <prog-opts/>
    </job>
    <job>
      <name>count-lines</name>
      <prog-exec-loc>wc</prog-exec-loc>
      <prog-args/>
      <prog-opts>
          <flag>-l</flag>
          <val/>
      </prog-opts>
      <deps>
        <dep>dir2-contents</dep>
      </deps>
    </job>
    <job>
      <name>build-sq-sum-commands</name>
      <prog-exec-loc>awk</prog-exec-loc>
      <prog-args>
        <arg>'{print "a = a + " $1} END {print "a";}'</arg>
      </prog-args>
      <prog-opts/>
      <deps>
        <dep>count-lines</dep>
      </deps>
    </job>
    <job>
      <name>compute-sq-sum</name>
      <prog-exec-loc>bc</prog-exec-loc>
      <prog-args/>
      <prog-opts/>
      <deps>
        <dep>build-sq-sum-commands</dep>
      </deps>
    </job>
    <job>
      <name>sq-sum-pr</name>
      <prog-exec-loc>ruby</prog-exec-loc>
      <prog-args/>
      <prog-opts>
        <opt>
          <flag>-lane</flag>
          <val>'puts "A. sum of sq. of num files=" + $F[0].to_s'</val>
        </opt>
      </prog-opts>
      <deps>
        <dep>compute-sq-sum</dep>
      </deps>
    </job>
    <job>
      <name>sort-output</name>
      <prog-exec-loc>sort</prog-exec-loc>
      <prog-args/>
      <prog-opts/>
      <deps>
        <dep>sq-sum-pr</dep>
        <dep>sum-pr</dep>
      </deps>
    </job>
  </jobs>
</workflow>

